name: Kontrolli Linuxi harjutuse esitamist

on: [push, pull_request]

jobs:
  kontroll:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v3

    - name: Kontrolli failide olemasolu
      run: |
        test -f harjutus/minu_fail.txt || (echo "âŒ Puudub: harjutus/minu_fail.txt" && exit 1)
        test -f harjutus/vÃµrgu_logid.txt || (echo "âŒ Puudub: harjutus/vÃµrgu_logid.txt" && exit 1)
        test -f harjutus/kasutatud_kÃ¤sud.txt || (echo "âŒ Puudub: harjutus/kasutatud_kÃ¤sud.txt" && exit 1)

    - name: Kontrolli faili sisu
      run: |
        grep -Fxq "See on testfail Linuxi harjutuse jaoks." harjutus/minu_fail.txt || (echo "âŒ Tekst ei sobi failis: minu_fail.txt" && exit 1)

    - name: Kontrolli faili Ãµigusi
      run: |
        perms=$(stat -c "%a" harjutus/minu_fail.txt)
        if [ "$perms" != "600" ]; then
          echo "âŒ Faili Ãµigused on $perms, aga oodati 600"
          exit 1
        fi

    - name: Kontrolli, et vÃµrgu_logid.txt pole tÃ¼hi
      run: |
        if [ ! -s harjutus/vÃµrgu_logid.txt ]; then
          echo "âŒ Fail harjutus/vÃµrgu_logid.txt on tÃ¼hi"
          exit 1
        fi

    - name: Kontroll edukalt lÃ¤bitud ğŸ‰
      run: echo "âœ… KÃµik vajalikud failid olemas ja kontrollitud!"
